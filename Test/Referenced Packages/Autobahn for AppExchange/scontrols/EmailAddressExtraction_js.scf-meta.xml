<?xml version="1.0" encoding="UTF-8"?>
<Scontrol xmlns="http://soap.sforce.com/2006/04/metadata">
    <contentSource>Snippet</contentSource>
    <description>EmailAddressExtraction_js</description>
    <encodingKey>UTF-8</encodingKey>
    <fileContent>Ly8gMjAwOTEyMDQNCi8vIEVtYWlsQWRkcmVzc0V4dHJhY3Rpb24NCi8vDQoNCi8vIEhpZ2hsaWdodGluZyBUYWIgZnJvbSBXaXRoaW4gc0NvbnRyb2wuIGh0dHA6Ly93d3cuaW50ZXJhY3RpdmV0aWVzLmNvbS9iX2hpZ2hsaWdodF90YWIucGhwDQp2YXIgdGFiQmFyID0gcGFyZW50LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0YWJCYXIiKTsNCmlmICh0YWJCYXIgIT0gbnVsbCkgDQp7DQogIHZhciBwYXJlbnRUYWJsZSA9IHRhYkJhci5yb3dzWzBdOyAvL2Fzc2lnbiB0aGUgZmlyc3Qgcm93IG9mIHRoZSBwYXJlbnQgZG9jdW1lbnQgdGFibGUgd2l0aCB0aGUgSWQgInRhYkJhciIgdG8gYSB2YXJpYWJsZQ0KICBmb3IgKHZhciBhIGluIHBhcmVudFRhYmxlLmNlbGxzKSB7IC8vZm9yIGFsbCBjZWxscyAoVERzKSBpbiB0aGF0IHJvdyAoVFIpDQoJICB2YXIgdGFibGVDZWxsID0gcGFyZW50VGFibGUuY2VsbHNbYV0uaW5uZXJIVE1MOyAvL2Fzc2lnbiB0aGUgaW5uZXIgSFRNTCBvZiBlYWNoIFREIHRvIGEgdmFyaWFibGUNCgkgIGlmICh0eXBlb2YodGFibGVDZWxsKSA9PSAic3RyaW5nIikgeyAvL2lmIHRoZSB0eXBlIG9mIHRoZSB0YWJsZUNlbGwgdmFyaWFibGUgaXMgInN0cmluZyINCgkJICBpZiAodGFibGVDZWxsLmluZGV4T2YoIpKKj2+P8IyPkN2S6CIpICE9IC0xKSB7IC8vbG9vayBhdCB0aGUgY29udGVudHMgb2YgdGhlIHN0cmluZyBhbmQgc2VlIGlmIHlvdSBmaW5kIHRoZSBkZWNsYXJhdGlvbiBvZiB0aGUgcGFnZXMgQk9EWSB0YWcNCgkJCSAgcGFyZW50VGFibGUuY2VsbHNbYV0uY2xhc3NOYW1lID0gImN1cnJlbnRUYWIgcHJpbWFyeVBhbGV0dGUiOyAvL3VwZGF0ZSB0aGUgY2xhc3MgZGVjbGFyYXRpb24gb2YgdGhlIHRhYmxlIGNlbGwgdGhhdCB3ZSBhcmUgY3VycmVudGx5IHdpdGhpbg0KCQkgIH0NCgkJICBpZiAodGFibGVDZWxsLmluZGV4T2YoIoOBgVuDi4N3g2KDX5DdkugiKSAhPSAtMSkgeyAvL2xvb2sgYXQgdGhlIGNvbnRlbnRzIG9mIHRoZSBzdHJpbmcgYW5kIHNlZSBpZiB5b3UgZmluZCB0aGUgZGVjbGFyYXRpb24gb2YgdGhlIHBhZ2VzIEJPRFkgdGFnDQoJCQkgIHBhcmVudFRhYmxlLmNlbGxzW2FdLmNsYXNzTmFtZSA9ICIiOw0KCQkgIH0NCgkgIH0NCiAgfQ0KfQ0KDQpmdW5jdGlvbiBpbml0RW1haWxBZGRyZXNzRXh0cmFjdGlvbigpDQp7DQogICAgJCgiZGF0YXNvdXJjZSIpLm9uY2hhbmdlID0gY2hhbmdlRmllbGRPYmplY3RzOw0KDQogICAgdmFyIGlkID0gInshVFJDX0FCX19BdXRvYmFobkVtYWlsQWRkcmVzc0V4dHJhY3Rpb25fX2MuSWR9IjsNCiAgICBpZiAoaWQgPT0gIiIpDQogICAgew0KICAgICAgICBpbml0Q3JlYXRpbmcoKTsNCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgICAgaW5pdFVwZGF0aW5nKCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBpbml0Q3JlYXRpbmcoKQ0Kew0KICAgIGdldFNvdXJjZU9iamVjdCgpOw0KICAgIHNldENyaXRlcmlhKCk7DQp9DQoNCmZ1bmN0aW9uIGluaXRVcGRhdGluZygpDQp7DQogICAgdmFyIGFkZHJlc3NfZXh0cmFjdGlvbiA9IHNmb3JjZS5jb25uZWN0aW9uLnJldHJpZXZlKCJJZCwgTmFtZSwgVFJDX0FCX19OYW1lX19jLCBUUkNfQUJfX0RhdGFTb3VyY2VfX2MsIFRSQ19BQl9fRW1haWxGaWVsZF9fYywgVFJDX0FCX19Dcml0ZXJpYV9fYyIsICJUUkNfQUJfX0F1dG9iYWhuRW1haWxBZGRyZXNzRXh0cmFjdGlvbl9fYyIsIFsieyFUUkNfQUJfX0F1dG9iYWhuRW1haWxBZGRyZXNzRXh0cmFjdGlvbl9fYy5JZH0iXSlbMF07DQogICAgDQogICAgdmFyIGlkID0gYWRkcmVzc19leHRyYWN0aW9uLklkOw0KICAgIHZhciBuYW1lID0gYWRkcmVzc19leHRyYWN0aW9uLk5hbWU7DQogICAgdmFyIHN0b3JlZF9uYW1lID0gYWRkcmVzc19leHRyYWN0aW9uLlRSQ19BQl9fTmFtZV9fYzsNCiAgICB2YXIgc3RvcmVkX2RhdGFzb3VyY2UgPSBhZGRyZXNzX2V4dHJhY3Rpb24uVFJDX0FCX19EYXRhU291cmNlX19jOw0KICAgIHZhciBzdG9yZWRfZW1haWxmaWVsZCA9IGFkZHJlc3NfZXh0cmFjdGlvbi5UUkNfQUJfX0VtYWlsRmllbGRfX2M7DQogICAgdmFyIHN0b3JlZF9jcml0ZXJpYSA9IGFkZHJlc3NfZXh0cmFjdGlvbi5UUkNfQUJfX0NyaXRlcmlhX19jOw0KDQogICAgc2V0TmFtZShzdG9yZWRfbmFtZSk7DQoNCiAgICBnZXRTb3VyY2VPYmplY3QoKTsNCiAgICBzZXREYXRhU291cmNlKHN0b3JlZF9kYXRhc291cmNlKTsNCg0KICAgIGdldEZpZWxkT2JqZWN0cygpOw0KICAgIGNyZWF0ZUVtYWlsRmllbGQoc3RvcmVkX2VtYWlsZmllbGQpOw0KICAgIHNldENyaXRlcmlhKHN0b3JlZF9jcml0ZXJpYSk7DQp9DQoNCmZ1bmN0aW9uIFNvdXJjZU9iamVjdHMoKQ0Kew0KICAgIHRoaXMub2JqZWN0cyA9IG5ldyBBcnJheSgpOw0KfQ0KU291cmNlT2JqZWN0cy5wcm90b3R5cGUuZ2V0T2JqZWN0ID0gZnVuY3Rpb24oc29iamVjdE5hbWUpDQp7DQogICAgcmV0dXJuIHRoaXMub2JqZWN0c1tzb2JqZWN0TmFtZV07DQp9Ow0KU291cmNlT2JqZWN0cy5wcm90b3R5cGUuYWRkT2JqZWN0ID0gZnVuY3Rpb24oc291cmNlX29iamVjdCkNCnsNCiAgICB0aGlzLm9iamVjdHNbc291cmNlX29iamVjdC5zb2JqZWN0TmFtZV0gPSBzb3VyY2Vfb2JqZWN0Ow0KfTsNCnZhciBzb3VyY2Vfb2JqZWN0cyA9IG5ldyBTb3VyY2VPYmplY3RzKCk7DQoNCmZ1bmN0aW9uIGdldFNvdXJjZU9iamVjdCgpDQp7DQogICAgdmFyIHMgPSBzZm9yY2UuY29ubmVjdGlvbi5kZXNjcmliZVRhYnMoKTsNCiAgICB2YXIgc3RyaW5ncyA9IG5ldyBBcnJheSgpOw0KICAgICRBKHMpLmVhY2goZnVuY3Rpb24odGFiY29udGFpbmVyKQ0KICAgIHsNCiAgICAgICAgJEEodGFiY29udGFpbmVyLnRhYnMpLmVhY2goZnVuY3Rpb24odGFiKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAodGFiLnNvYmplY3ROYW1lICE9IG51bGwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIHNvdXJjZV9vYmplY3QgPSBuZXcgT2JqZWN0KCk7DQogICAgICAgICAgICAgICAgc291cmNlX29iamVjdC5sYWJlbCA9IHRhYi5sYWJlbDsNCiAgICAgICAgICAgICAgICBzb3VyY2Vfb2JqZWN0LnNvYmplY3ROYW1lID0gdGFiLnNvYmplY3ROYW1lOw0KICAgICAgICAgICAgICAgIHNvdXJjZV9vYmplY3RzLmFkZE9iamVjdChzb3VyY2Vfb2JqZWN0KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQogICAgdmFyIHNvdXJjZV9vYmplY3QgPSBuZXcgT2JqZWN0KCk7DQogICAgc291cmNlX29iamVjdC5sYWJlbCA9ICKDTIODg5ODeYFbg5ODgYOTg2+BWyI7DQogICAgc291cmNlX29iamVjdC5zb2JqZWN0TmFtZSA9ICJDYW1wYWlnbk1lbWJlciI7DQogICAgc291cmNlX29iamVjdHMuYWRkT2JqZWN0KHNvdXJjZV9vYmplY3QpOw0KICAgIA0KICAgIHZhciBzID0gc2ZvcmNlLmNvbm5lY3Rpb24uZGVzY3JpYmVHbG9iYWwoKTsNCg0KICAgIHZhciBvcHRpb25zdHJpbmdzID0gbmV3IEFycmF5KCRBKHMuZmllbGRzKS5sZW5ndGgpOw0KICAgIG9wdGlvbnN0cmluZ3MucHVzaCgnPG9wdGlvbiB2YWx1ZT0iIj4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE5vbmUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPC9vcHRpb24+Jyk7DQogICAgJEEocy50eXBlcykuZWFjaChmdW5jdGlvbih0eXBlKQ0KICAgIHsNCiAgICAgICAgc291cmNlX29iamVjdCA9IHNvdXJjZV9vYmplY3RzLmdldE9iamVjdCh0eXBlKTsNCiAgICAgICAgaWYgKHNvdXJjZV9vYmplY3QgIT0gbnVsbCkNCiAgICAgICAgew0KICAgICAgICAgICAgb3B0aW9uc3RyaW5ncy5wdXNoKCc8b3B0aW9uIHZhbHVlPSInICsgc291cmNlX29iamVjdC5zb2JqZWN0TmFtZSArICciPicgKyBzb3VyY2Vfb2JqZWN0LmxhYmVsICsgJzwvb3B0aW9uPicpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgdmFyIG9wdGlvbnN0cmluZyA9IG9wdGlvbnN0cmluZ3Muam9pbigiXG4iKTsNCg0KICAgIHZhciBzZWxlY3RzdHJpbmcgPSAnPHNlbGVjdCBpZD0iZGF0YXNvdXJjZSIgbmFtZT0iZGF0YXNvdXJjZSI+XG4nOw0KICAgIHNlbGVjdHN0cmluZyArPSBvcHRpb25zdHJpbmc7DQogICAgc2VsZWN0c3RyaW5nICs9ICc8L3NlbGVjdD5cbic7DQoNCiAgICAkKCJkYXRhc291cmNlX2RpdiIpLmlubmVySFRNTCA9IHNlbGVjdHN0cmluZzsNCg0KICAgICQoImRhdGFzb3VyY2UiKS5vbmNoYW5nZSA9IGNoYW5nZUZpZWxkT2JqZWN0czsNCn0NCg0KdmFyIGNyaXRlcmlhX2NvdW50ID0gMDsNCnZhciBmaWVsZF9vYmplY3RzID0gbmV3IEFycmF5KCk7DQpmdW5jdGlvbiBnZXRGaWVsZE9iamVjdHMoKQ0Kew0KICAgIGZpZWxkX29iamVjdHMgPSBkZXNjcmliZVNPYmplY3RzKCQoImRhdGFzb3VyY2UiKS5vcHRpb25zWyQoImRhdGFzb3VyY2UiKS5zZWxlY3RlZEluZGV4XS52YWx1ZSk7DQp9DQoNCmZ1bmN0aW9uIGNoYW5nZUZpZWxkT2JqZWN0cygpDQp7DQogICAgZ2V0RmllbGRPYmplY3RzKCk7DQogICAgY3JlYXRlRW1haWxGaWVsZCgpOw0KICAgIGZvciAoY291bnQgPSAxOyBjb3VudCA8PSBjcml0ZXJpYV9jb3VudCAtIDE7ICsrY291bnQpDQogICAgew0KICAgICAgICBjcmVhdGVDcml0ZXJpYUZpZWxkKGNvdW50KTsNCiAgICAgICAgc2V0Q3JpdGVyaWFGaWVsZChjb3VudCwgIiIpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gY2hhbmdlRmllbGQoZSkNCnsNCiAgICB2YXIgZmllbGRfb2JqZWN0cyA9IGRlc2NyaWJlU09iamVjdHMoJCgiZGF0YXNvdXJjZSIpLm9wdGlvbnNbJCgiZGF0YXNvdXJjZSIpLnNlbGVjdGVkSW5kZXhdLnZhbHVlKTsNCiAgICB2YXIgb2JqID0gbnVsbDsNCiAgICBmaWVsZF9vYmplY3RzLmVhY2goZnVuY3Rpb24oZmllbGRfb2JqZWN0KQ0KICAgIHsNCiAgICAgICAgaWYgKGZpZWxkX29iamVjdC5uYW1lID09IGUudmFsdWUpDQogICAgICAgIHsNCiAgICAgICAgICBvYmogPSBmaWVsZF9vYmplY3Q7DQogICAgICAgIH0NCiAgICB9KTsNCg0KdmFyIG9wZXJhbmRzID0ge307DQpvcGVyYW5kc1siaWQiXSAgICAgICAgPSBuZXcgQXJyYXkoImUiLCAibiIsICJzIiwgImMiLCAiayIpOw0Kb3BlcmFuZHNbInJlZmVyZW5jZSJdID0gbmV3IEFycmF5KCJlIiwgIm4iLCAicyIsICJjIiwgImsiKTsNCm9wZXJhbmRzWyJzdHJpbmciXSAgICA9IG5ldyBBcnJheSgiZSIsICJuIiwgInMiLCAiYyIsICJrIiwgImwiLCAiZyIsICJtIiwgImgiKTsNCm9wZXJhbmRzWyJ0ZXh0YXJlYSJdICA9IG5ldyBBcnJheSgiZSIsICJuIiwgInMiLCAiYyIsICJrIiwgImwiLCAiZyIsICJtIiwgImgiKTsNCm9wZXJhbmRzWyJwaG9uZSJdICAgICA9IG5ldyBBcnJheSgiZSIsICJuIiwgInMiLCAiYyIsICJrIiwgImwiLCAiZyIsICJtIiwgImgiKTsNCm9wZXJhbmRzWyJlbWFpbCJdICAgICA9IG5ldyBBcnJheSgiZSIsICJuIiwgInMiLCAiYyIsICJrIiwgImwiLCAiZyIsICJtIiwgImgiKTsNCm9wZXJhbmRzWyJ1cmwiXSAgICAgICA9IG5ldyBBcnJheSgiZSIsICJuIiwgInMiLCAiYyIsICJrIiwgImwiLCAiZyIsICJtIiwgImgiKTsNCm9wZXJhbmRzWyJib29sZWFuIl0gICA9IG5ldyBBcnJheSgiZSIsICJuIik7DQpvcGVyYW5kc1sicGlja2xpc3QiXSAgPSBuZXcgQXJyYXkoInUiLCAieCIpOw0Kb3BlcmFuZHNbImRhdGUiXSAgICAgID0gbmV3IEFycmF5KCJlIiwgIm4iLCAibCIsICJnIiwgIm0iLCAiaCIpOw0Kb3BlcmFuZHNbImRhdGV0aW1lIl0gID0gbmV3IEFycmF5KCJlIiwgIm4iLCAibCIsICJnIiwgIm0iLCAiaCIpOw0Kb3BlcmFuZHNbImN1cnJlbmN5Il0gID0gbmV3IEFycmF5KCJlIiwgIm4iLCAibCIsICJnIiwgIm0iLCAiaCIpOw0Kb3BlcmFuZHNbImludCJdICAgICAgID0gbmV3IEFycmF5KCJlIiwgIm4iLCAibCIsICJnIiwgIm0iLCAiaCIpOw0KdmFyIG9wZXJhbmR0eXBlcyA9IHt9Ow0Kb3BlcmFuZHR5cGVzWyJlIl0gPSB7IHZhbHVlOiAiZSIsIHRleHQ6ICKOn4LMlbaOmpfxgsaI6pJ2greC6SIgfTsNCm9wZXJhbmR0eXBlc1sibiJdID0geyB2YWx1ZTogIm4iLCB0ZXh0OiAijp+CzJW2jpqX8YLGiOqSdoK1gsiCoiIgfTsNCm9wZXJhbmR0eXBlc1sicyJdID0geyB2YWx1ZTogInMiLCB0ZXh0OiAijp+CzJW2jpqX8YLFjm6C3ILpIiB9Ow0Kb3BlcmFuZHR5cGVzWyJjIl0gPSB7IHZhbHVlOiAiYyIsIHRleHQ6ICKOn4LMlbaOmpfxgvCK3ILeIiB9Ow0Kb3BlcmFuZHR5cGVzWyJrIl0gPSB7IHZhbHVlOiAiayIsIHRleHQ6ICKOn4LMlbaOmpfxgvCK3ILcgsiCoiIgfTsNCm9wZXJhbmR0eXBlc1sibCJdID0geyB2YWx1ZTogImwiLCB0ZXh0OiAigYMiIH07DQpvcGVyYW5kdHlwZXNbImciXSA9IHsgdmFsdWU6ICJnIiwgdGV4dDogIoGEIiB9Ow0Kb3BlcmFuZHR5cGVzWyJtIl0gPSB7IHZhbHVlOiAibSIsIHRleHQ6ICKBg4GBIiB9Ow0Kb3BlcmFuZHR5cGVzWyJoIl0gPSB7IHZhbHVlOiAiaCIsIHRleHQ6ICKBhIGBIiB9Ow0Kb3BlcmFuZHR5cGVzWyJ1Il0gPSB7IHZhbHVlOiAidSIsIHRleHQ6ICKOn4LMkmyC8Ircgt4iIH07DQpvcGVyYW5kdHlwZXNbIngiXSA9IHsgdmFsdWU6ICJ4IiwgdGV4dDogIo6fgsySbILwityC3ILIgqIiIH07DQoNCg0KLy9hbGVydChvcGVyYW5kc1tvYmoudHlwZS5zcGxpdCgiLiIpLnBvcCgpXSk7DQovL2FsZXJ0KG9iai50eXBlICsgJyAtICcgKyBvYmouc29hcFR5cGUpOw0KDQogICAgdmFyIHR5cGUgPSBvYmoudHlwZS5zcGxpdCgiLiIpLnBvcCgpOw0KICAgIHZhciBvcGVyYW5kID0gZG9qby5ieUlkKCJvcGVyYW5kXyIgKyBlLmlkLnNwbGl0KCJfIikucG9wKCkpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBvcGVyYW5kLm9wdGlvbnMubGVuZ3RoOyArK2kpDQogICAgew0KICAgICAgb3BlcmFuZC5vcHRpb25zW2ldLnN0eWxlLmRpc3BsYXkgPSAob3BlcmFuZHNbb2JqLnR5cGUuc3BsaXQoIi4iKS5wb3AoKV0uaW5kZXhPZihvcGVyYW5kLm9wdGlvbnNbaV0udmFsdWUpICE9IC0xKSA/ICIiIDogIm5vbmUiOw0KICAgIH0NCg0KICAgIHZhciBvcHRpb25fb3BlcmFuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLnNldEF0dHJpYnV0ZSgidGVzdCIsICJ0ZXN0Iik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gInRlc3QiOw0KICAgIG9wZXJhbmQuYXBwZW5kQ2hpbGQob3B0aW9uX29wZXJhbmQpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBvcGVyYW5kLm9wdGlvbnMubGVuZ3RoOyArK2kpDQogICAgew0KICAgICAgb3BlcmFuZC5yZW1vdmVDaGlsZCgpOw0KICAgIH0NCiAgICANCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgIiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLmlubmVySFRNTCA9ICItLU5vbmUtLSI7DQogICAgc2VsZWN0X29wZXJhbmQuYXBwZW5kQ2hpbGQob3B0aW9uX29wZXJhbmQpOw0KDQogICAgdmFyIG9wdGlvbl9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX29wZXJhbmQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICJlIik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIo6fgsyVto6al/GCxojqknaCt4LpIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCg0KfQ0KDQpmdW5jdGlvbiBzZXROYW1lKHZhbHVlKQ0Kew0KICAgICQoIm5hbWUiKS52YWx1ZSA9IHZhbHVlOw0KfQ0KDQpmdW5jdGlvbiBzZXREYXRhU291cmNlKHZhbHVlKQ0Kew0KICAgICRBKCQoImRhdGFzb3VyY2UiKS5vcHRpb25zKS5lYWNoKGZ1bmN0aW9uKG9wdGlvbil7DQogICAgCWlmIChvcHRpb24udmFsdWUgPT0gdmFsdWUpDQogICAgCXsNCiAgICAJICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7DQoJICAgIH0NCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gc2V0RW1haWxGaWVsZCh2YWx1ZSkNCnsNCiAgICAvL3JlcGxhY2VkIHRvIGNyZWF0ZUVtYWlsRmllbGQodmFsdWUpOw0KfQ0KDQpmdW5jdGlvbiBzZXRDcml0ZXJpYShjcml0ZXJpYV9zdHJpbmcpDQp7DQogICAgY3JpdGVyaWFfY291bnQgPSAwOw0KICAgIGNyZWF0ZU1hdGNoKCk7DQogICAgaWYgKHR5cGVvZihjcml0ZXJpYV9zdHJpbmcpICE9ICd1bmRlZmluZWQnKQ0KICAgIHsNCiAgICAgICAgdmFyIHhtbG9iaiA9IG5ldyBYTUwuT2JqVHJlZSgpOw0KICAgICAgICB2YXIgeG1sdHJlZSA9IHhtbG9iai5wYXJzZVhNTChjcml0ZXJpYV9zdHJpbmcpOw0KDQogICAgICAgIHNldENyaXRlcmlhTWF0Y2goeG1sdHJlZS5jcml0ZXJpYXMubWF0Y2gpOw0KDQogICAgICAgICRBKHhtbHRyZWUuY3JpdGVyaWFzLmNyaXRlcmlhKS5lYWNoKGZ1bmN0aW9uKGNyaXRlcmlhKQ0KICAgICAgICB7DQogICAgICAgICAgICArK2NyaXRlcmlhX2NvdW50Ow0KICAgICAgICAgICAgY3JlYXRlQ3JpdGVyaWEoY3JpdGVyaWFfY291bnQpOw0KICAgICAgICAgICAgc2V0Q3JpdGVyaWFGaWVsZChjcml0ZXJpYV9jb3VudCwgY3JpdGVyaWEuZmllbGQpOw0KICAgICAgICAgICAgc2V0Q3JpdGVyaWFPcGVyYW5kKGNyaXRlcmlhX2NvdW50LCBjcml0ZXJpYS5vcGVyYW5kKTsNCiAgICAgICAgICAgIHNldENyaXRlcmlhVmFsdWUoY3JpdGVyaWFfY291bnQsIGNyaXRlcmlhLnZhbHVlKTsNCiAgICAgICAgfSk7DQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICBzZXRDcml0ZXJpYU1hdGNoKCJhbmQiKTsNCiAgICB9DQogICAgZm9yICgrK2NyaXRlcmlhX2NvdW50OyBjcml0ZXJpYV9jb3VudCA8PSAxMDsgKytjcml0ZXJpYV9jb3VudCkNCiAgICB7DQogICAgICAgIGNyZWF0ZUNyaXRlcmlhKGNyaXRlcmlhX2NvdW50KTsNCiAgICAgICAgc2V0Q3JpdGVyaWFGaWVsZChjcml0ZXJpYV9jb3VudCwgIiIpOw0KICAgICAgICBzZXRDcml0ZXJpYU9wZXJhbmQoY3JpdGVyaWFfY291bnQsICIiKTsNCiAgICAgICAgc2V0Q3JpdGVyaWFWYWx1ZShjcml0ZXJpYV9jb3VudCwgIiIpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gc2V0Q3JpdGVyaWFNYXRjaChtYXRjaCkNCnsNCiAgJCgobWF0Y2ggPT0gIm9yIikgPyAibWF0Y2hfb3IiIDogIm1hdGNoX2FuZCIpLmNoZWNrZWQgPSB0cnVlOw0KfQ0KZnVuY3Rpb24gc2V0Q3JpdGVyaWFGaWVsZChpZCwgdmFsdWUpDQp7DQogICAgJEEoJCgiZmllbGRfIiArIGlkKS5vcHRpb25zKS5lYWNoKGZ1bmN0aW9uKG9wdGlvbil7DQogICAgCWlmIChvcHRpb24udmFsdWUgPT0gdmFsdWUpIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7DQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHNldENyaXRlcmlhT3BlcmFuZChpZCwgdmFsdWUpDQp7DQogICAgJEEoJCgib3BlcmFuZF8iICsgaWQpLm9wdGlvbnMpLmVhY2goZnVuY3Rpb24ob3B0aW9uKXsNCiAgICAJaWYgKG9wdGlvbi52YWx1ZSA9PSB2YWx1ZSkgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gc2V0Q3JpdGVyaWFWYWx1ZShpZCwgdmFsdWUpDQp7DQogICAgJCgidmFsdWVfIiArIGlkKS52YWx1ZSA9ICh0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcpID8gIiIgOiB2YWx1ZTsNCn0NCg0KZnVuY3Rpb24gY3JlYXRlRW1haWxGaWVsZChzZWxlY3RlZG5hbWUpDQp7DQogICAgdmFyIGVtYWlsZmllbGQgPSAkKCJlbWFpbGZpZWxkIik7DQogICAgZG9qby5kb20ucmVtb3ZlQ2hpbGRyZW4oZW1haWxmaWVsZCk7DQoNCiAgICB2YXIgb3B0aW9uX2ZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX2ZpZWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCAiIik7DQogICAgb3B0aW9uX2ZpZWxkLmlubmVySFRNTCA9ICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIE5vbmUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIjsNCiAgICBlbWFpbGZpZWxkLmFwcGVuZENoaWxkKG9wdGlvbl9maWVsZCk7DQogICAgdmFyIHNlbGVjdGVkc2V0ID0gZmFsc2U7DQogICAgZmllbGRfb2JqZWN0cy5lYWNoKGZ1bmN0aW9uKGZpZWxkX29iamVjdCkNCiAgICB7DQogICAgICAgIHZhciBvcHRpb25fZmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICAgICAgb3B0aW9uX2ZpZWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCBmaWVsZF9vYmplY3QubmFtZSk7DQogICAgICAgIGlmIChmaWVsZF9vYmplY3QubmFtZSA9PSBzZWxlY3RlZG5hbWUpDQogICAgICAgIHsNCiAgICAgICAgICAgIG9wdGlvbl9maWVsZC5zZXRBdHRyaWJ1dGUoInNlbGVjdGVkIiwgInNlbGVjdGVkIik7DQogICAgICAgICAgICBzZWxlY3RlZHNldCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZiAoZmllbGRfb2JqZWN0Lm5hbWUuaW5kZXhPZigiLkVtYWlsIikgIT0gLTEgJiYgc2VsZWN0ZWRzZXQgPT0gZmFsc2UpIA0KICAgICAgICB7DQogICAgICAgICAgICBvcHRpb25fZmllbGQuc2V0QXR0cmlidXRlKCJzZWxlY3RlZCIsICJzZWxlY3RlZCIpOw0KICAgICAgICAgICAgc2VsZWN0ZWRzZXQgPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIG9wdGlvbl9maWVsZC5pbm5lckhUTUwgPSBmaWVsZF9vYmplY3QubGFiZWw7DQogICAgICAgIGVtYWlsZmllbGQuYXBwZW5kQ2hpbGQob3B0aW9uX2ZpZWxkKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gY3JlYXRlTWF0Y2goKQ0Kew0KICAgIHZhciB0YWJsZSA9ICQoImRhdGEiKTsNCiAgICB2YXIgdHIgPSB0YWJsZS5pbnNlcnRSb3coLTEpOw0KICAgIHZhciB0ZF9uYW1lID0gdHIuaW5zZXJ0Q2VsbCgtMSk7DQogICAgdmFyIHRkX2RhdGEgPSB0ci5pbnNlcnRDZWxsKC0xKTsNCiAgICB2YXIgdGRfZW1wdHkxID0gdHIuaW5zZXJ0Q2VsbCgtMSk7DQogICAgdmFyIHRkX2VtcHR5MiA9IHRyLmluc2VydENlbGwoLTEpOw0KDQogICAgdGRfbmFtZS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImxhYmVsQ29sIik7DQogICAgdGRfZW1wdHkxLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAibGFiZWxDb2wgZW1wdHkiKTsNCiAgICB0ZF9lbXB0eTIuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJkYXRhQ29sIGVtcHR5Iik7DQogICAgdGRfZW1wdHkxLmlubmVySFRNTCA9ICImbmJzcDsiOw0KICAgIHRkX2VtcHR5Mi5pbm5lckhUTUwgPSAiJm5ic3A7IjsNCg0KICAgIHZhciBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxhYmVsIik7DQogICAgbGFiZWwuaW5uZXJIVE1MID0gIjxkaXYgc3R5bGU9XCJmb250LXdlaWdodDogYm9sZFw7IHRleHQtYWxpZ246IHJpZ2h0XDtcIj6P8IyPPC9kaXY+IjsNCg0KICAgIHRkX25hbWUuYXBwZW5kQ2hpbGQobGFiZWwpOw0KDQogICAgdGRfZGF0YS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImRhdGFDb2wgY29sMDIiKTsNCg0KICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsNCiAgICBkaXYuaW5uZXJIVE1MID0gJzxpbnB1dCB0eXBlPSJyYWRpbyIgaWQ9Im1hdGNoX2FuZCIgbmFtZT0ibWF0Y2giIHZhbHVlPSJhbmQiIGNoZWNrZWQ9ImNoZWNrZWQiIC8+PGxhYmVsIGZvcj0ibWF0Y2hfYW5kIj6Ct4LXgsSCzI/wjI+CyYjqknY8L2xhYmVsPiZuYnNwOycNCiAgICAgICAgICAgICAgICAgICsgJzxpbnB1dCB0eXBlPSJyYWRpbyIgaWQ9Im1hdGNoX29yIiAgbmFtZT0ibWF0Y2giIHZhbHVlPSJvciIgLz48bGFiZWwgZm9yPSJtYXRjaF9vciI+gqKCuILqgqmCzI/wjI+CyYjqknY8L2xhYmVsPic7DQoNCiAgICB0ZF9kYXRhLmFwcGVuZENoaWxkKGRpdik7DQp9DQoNCmZ1bmN0aW9uIGNyZWF0ZUNyaXRlcmlhKGlkKQ0Kew0KICAgIHZhciB0YWJsZSA9ICQoImRhdGEiKTsNCiAgICB2YXIgdHIgPSB0YWJsZS5pbnNlcnRSb3coLTEpOw0KICAgIHZhciB0ZF9uYW1lID0gdHIuaW5zZXJ0Q2VsbCgtMSk7DQogICAgdmFyIHRkX2RhdGEgPSB0ci5pbnNlcnRDZWxsKC0xKTsNCiAgICB2YXIgdGRfZW1wdHkxID0gdHIuaW5zZXJ0Q2VsbCgtMSk7DQogICAgdmFyIHRkX2VtcHR5MiA9IHRyLmluc2VydENlbGwoLTEpOw0KDQogICAgdGRfbmFtZS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImxhYmVsQ29sIik7DQogICAgdGRfZW1wdHkxLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAibGFiZWxDb2wgZW1wdHkiKTsNCiAgICB0ZF9lbXB0eTIuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJkYXRhQ29sIGVtcHR5Iik7DQogICAgdGRfZW1wdHkxLmlubmVySFRNTCA9ICImbmJzcDsiOw0KICAgIHRkX2VtcHR5Mi5pbm5lckhUTUwgPSAiJm5ic3A7IjsNCg0KICAgIC8vdmFyIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGFiZWwiKTsNCiAgICAvL2lmIChpZCA9PSAxKQ0KICAgIC8vew0KICAgIC8vICAgIGxhYmVsLmlubmVySFRNTCA9ICI8ZGl2IHN0eWxlPVwiZm9udC13ZWlnaHQ6IGJvbGRcOyB0ZXh0LWFsaWduOiByaWdodFw7XCI+j/CMjzwvZGl2PiI7DQogICAgLy99DQoNCiAgICAvL3RkX25hbWUuYXBwZW5kQ2hpbGQobGFiZWwpOw0KICAgIA0KICAgIHRkX2RhdGEuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJkYXRhQ29sIGNvbDAyIik7DQoNCiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgZGl2LnNldEF0dHJpYnV0ZSgiaWQiLCAiY3JpdGVyaWFfIiArIGlkKTsNCiAgICBkaXYuc2V0QXR0cmlidXRlKCJuYW1lIiwgImNyaXRlcmlhIik7DQogICAgZGl2LnNldEF0dHJpYnV0ZSgic3R5bGUiLCAid2hpdGUtc3BhY2U6IG5vd3JhcCIpOw0KDQogICAgdmFyIHNwYW5fZmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7DQogICAgc3Bhbl9maWVsZC5zZXRBdHRyaWJ1dGUoImlkIiwgImZpZWxkXyIgKyBpZCArICJfc3BhbiIpOw0KDQogICAgdmFyIHNwYW5fb3BlcmFuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsNCiAgICBzcGFuX29wZXJhbmQuc2V0QXR0cmlidXRlKCJpZCIsICJvcGVyYW5kXyIgKyBpZCArICJfc3BhbiIpOw0KDQogICAgdmFyIHNwYW5fdmFsdWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7DQogICAgc3Bhbl92YWx1ZS5zZXRBdHRyaWJ1dGUoImlkIiwgInZhbHVlXyIgKyBpZCArICJfc3BhbiIpOw0KDQogICAgLy8gZmllbGQNCiAgICB2YXIgc2VsZWN0X2ZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2VsZWN0Iik7DQogICAgc2VsZWN0X2ZpZWxkLnNldEF0dHJpYnV0ZSgiaWQiLCAiZmllbGRfIiArIGlkKTsNCiAgICBzZWxlY3RfZmllbGQuc2V0QXR0cmlidXRlKCJuYW1lIiwgImZpZWxkIik7DQogICAgc2VsZWN0X2ZpZWxkLnNldEF0dHJpYnV0ZSgib25jbGljayIsICJjaGFuZ2VGaWVsZCh0aGlzKSIpOw0KDQogICAgdmFyIG9wdGlvbl9maWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgIG9wdGlvbl9maWVsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgIiIpOw0KICAgIG9wdGlvbl9maWVsZC5pbm5lckhUTUwgPSAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBOb25lLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSI7DQogICAgc2VsZWN0X2ZpZWxkLmFwcGVuZENoaWxkKG9wdGlvbl9maWVsZCk7DQoNCiAgICAvLyBvcGVyYW5kDQogICAgdmFyIHNlbGVjdF9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2VsZWN0Iik7DQogICAgc2VsZWN0X29wZXJhbmQuc2V0QXR0cmlidXRlKCJpZCIsICJvcGVyYW5kXyIgKyBpZCk7DQogICAgc2VsZWN0X29wZXJhbmQuc2V0QXR0cmlidXRlKCJuYW1lIiwgIm9wZXJhbmQiKTsNCg0KICAgIHZhciBvcHRpb25fb3BlcmFuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLnNldEF0dHJpYnV0ZSgidmFsdWUiLCAiIik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIi0tTm9uZS0tIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgImUiKTsNCiAgICBvcHRpb25fb3BlcmFuZC5pbm5lckhUTUwgPSAijp+CzJW2jpqX8YLGiOqSdoK3gukiOw0KICAgIHNlbGVjdF9vcGVyYW5kLmFwcGVuZENoaWxkKG9wdGlvbl9vcGVyYW5kKTsNCg0KICAgIHZhciBvcHRpb25fb3BlcmFuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLnNldEF0dHJpYnV0ZSgidmFsdWUiLCAibiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLmlubmVySFRNTCA9ICKOn4LMlbaOmpfxgsaI6pJ2grWCyIKiIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgInMiKTsNCiAgICBvcHRpb25fb3BlcmFuZC5pbm5lckhUTUwgPSAijp+CzJW2jpqX8YLFjm6C3ILpIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgImMiKTsNCiAgICBvcHRpb25fb3BlcmFuZC5pbm5lckhUTUwgPSAijp+CzJW2jpqX8YLwityC3iI7DQogICAgc2VsZWN0X29wZXJhbmQuYXBwZW5kQ2hpbGQob3B0aW9uX29wZXJhbmQpOw0KDQogICAgdmFyIG9wdGlvbl9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX29wZXJhbmQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICJrIik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIo6fgsyVto6al/GC8IrcgtyCyIKiIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7IA0KDQogICAgdmFyIG9wdGlvbl9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX29wZXJhbmQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICJsIik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIoGDIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgImciKTsNCiAgICBvcHRpb25fb3BlcmFuZC5pbm5lckhUTUwgPSAigYQiOw0KICAgIHNlbGVjdF9vcGVyYW5kLmFwcGVuZENoaWxkKG9wdGlvbl9vcGVyYW5kKTsNCg0KICAgIHZhciBvcHRpb25fb3BlcmFuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLnNldEF0dHJpYnV0ZSgidmFsdWUiLCAibSIpOw0KICAgIG9wdGlvbl9vcGVyYW5kLmlubmVySFRNTCA9ICKBg4GBIjsNCiAgICBzZWxlY3Rfb3BlcmFuZC5hcHBlbmRDaGlsZChvcHRpb25fb3BlcmFuZCk7DQoNCiAgICB2YXIgb3B0aW9uX29wZXJhbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fb3BlcmFuZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgImgiKTsNCiAgICBvcHRpb25fb3BlcmFuZC5pbm5lckhUTUwgPSAigYSBgSI7DQogICAgc2VsZWN0X29wZXJhbmQuYXBwZW5kQ2hpbGQob3B0aW9uX29wZXJhbmQpOw0KDQogICAgdmFyIG9wdGlvbl9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX29wZXJhbmQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICJ1Iik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIo6fgsySbILwityC3iI7DQogICAgc2VsZWN0X29wZXJhbmQuYXBwZW5kQ2hpbGQob3B0aW9uX29wZXJhbmQpOw0KDQogICAgdmFyIG9wdGlvbl9vcGVyYW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7DQogICAgb3B0aW9uX29wZXJhbmQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICJ4Iik7DQogICAgb3B0aW9uX29wZXJhbmQuaW5uZXJIVE1MID0gIo6fgsySbILwityC3ILIgqIiOw0KICAgIHNlbGVjdF9vcGVyYW5kLmFwcGVuZENoaWxkKG9wdGlvbl9vcGVyYW5kKTsNCg0KICAgIC8vIHRleHQNCiAgICB2YXIgdGV4dF92YWx1ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7DQogICAgdGV4dF92YWx1ZS5zZXRBdHRyaWJ1dGUoInR5cGUiLCAidGV4dCIpOw0KICAgIHRleHRfdmFsdWUuc2V0QXR0cmlidXRlKCJpZCIsICJ2YWx1ZV8iICsgaWQpOw0KICAgIHRleHRfdmFsdWUuc2V0QXR0cmlidXRlKCJuYW1lIiwgInZhbHVlIik7DQoNCiAgICAvLyBzcGFucw0KICAgIHNwYW5fZmllbGQuYXBwZW5kQ2hpbGQoc2VsZWN0X2ZpZWxkKTsNCiAgICBzcGFuX29wZXJhbmQuYXBwZW5kQ2hpbGQoc2VsZWN0X29wZXJhbmQpOw0KICAgIHNwYW5fdmFsdWUuYXBwZW5kQ2hpbGQodGV4dF92YWx1ZSk7DQoNCiAgICAvLyBkaXZzDQogICAgZGl2LmFwcGVuZENoaWxkKHNwYW5fZmllbGQpOw0KICAgIGRpdi5hcHBlbmRDaGlsZChzcGFuX29wZXJhbmQpOw0KICAgIGRpdi5hcHBlbmRDaGlsZChzcGFuX3ZhbHVlKTsNCiAgICB0ZF9kYXRhLmFwcGVuZENoaWxkKGRpdik7DQoNCg0KICAgIGNyZWF0ZUNyaXRlcmlhRmllbGQoaWQpOw0KfQ0KDQpmdW5jdGlvbiBjcmVhdGVDcml0ZXJpYU9wZXJhbmQoKQ0Kew0KfQ0KDQpmdW5jdGlvbiBjcmVhdGVDcml0ZXJpYUZpZWxkKGlkKQ0Kew0KICAgIHZhciBjcml0ZXJpYWZpZWxkID0gJCgiZmllbGRfIiArIGlkKTsNCiAgICBkb2pvLmRvbS5yZW1vdmVDaGlsZHJlbihjcml0ZXJpYWZpZWxkKTsNCg0KICAgIHZhciBvcHRpb25fZmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsNCiAgICBvcHRpb25fZmllbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICIiKTsNCiAgICBvcHRpb25fZmllbGQuaW5uZXJIVE1MID0gIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gTm9uZS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iOw0KICAgIGNyaXRlcmlhZmllbGQuYXBwZW5kQ2hpbGQob3B0aW9uX2ZpZWxkKTsNCiAgICBmaWVsZF9vYmplY3RzLmVhY2goDQogICAgICAgIGZ1bmN0aW9uKGZpZWxkX29iamVjdCkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIG9wdGlvbl9maWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOw0KICAgICAgICAgICAgb3B0aW9uX2ZpZWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCBmaWVsZF9vYmplY3QubmFtZSk7DQogICAgICAgICAgICBvcHRpb25fZmllbGQuaW5uZXJIVE1MID0gZmllbGRfb2JqZWN0LmxhYmVsOw0KICAgICAgICAgICAgY3JpdGVyaWFmaWVsZC5hcHBlbmRDaGlsZChvcHRpb25fZmllbGQpOw0KICAgICAgICB9DQogICAgKTsNCn0NCg0KZnVuY3Rpb24gZGVzY3JpYmVTT2JqZWN0cyhuYW1lLCBwYXJlbnQpDQp7DQogICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheSgpOw0KICAgIHZhciByZWZlcmVuY2VzID0gbmV3IEFycmF5KCk7DQoNCiAgICBpZiAobmFtZSA9PSAnJykgcmV0dXJuIHZhbHVlczsNCg0KICAgIHZhciBzb2JqZWN0ID0gc2ZvcmNlLmNvbm5lY3Rpb24uZGVzY3JpYmVTT2JqZWN0KG5hbWUpOyANCiAgICAkQShzb2JqZWN0LmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCkNCiAgICB7DQogICAgICAgIHZhciBmaWVsZF9vYmplY3QgPSBuZXcgT2JqZWN0KCk7DQogICAgICAgIHZhciBzb3VyY2Vfb2JqZWN0ID0gc291cmNlX29iamVjdHMuZ2V0T2JqZWN0KG5hbWUpOw0KICAgICAgICBpZiAoc291cmNlX29iamVjdCAhPSBudWxsKQ0KICAgICAgICB7DQogICAgICAgICAgICBmaWVsZF9vYmplY3QubmFtZSA9ICh0eXBlb2YgcGFyZW50ID09ICd1bmRlZmluZWQnKSA/IG5hbWUgKyAiLiIgKyBmaWVsZC5uYW1lIDogcGFyZW50Lm5hbWUgKyAiLiIgKyBuYW1lICsgIi4iICsgZmllbGQubmFtZTsNCiAgICAgICAgICAgIGZpZWxkX29iamVjdC5sYWJlbCA9ICh0eXBlb2YgcGFyZW50ID09ICd1bmRlZmluZWQnKSA/IHNvdXJjZV9vYmplY3QubGFiZWwgKyAiLiIgKyBmaWVsZC5sYWJlbCA6IHBhcmVudC5sYWJlbCArICIuIiArIHNvdXJjZV9vYmplY3QubGFiZWwgKyAiLiIgKyBmaWVsZC5sYWJlbDsNCiAgICAgICAgICAgIGZpZWxkX29iamVjdC50eXBlID0gKHR5cGVvZiBwYXJlbnQgPT0gJ3VuZGVmaW5lZCcpID8gc291cmNlX29iamVjdC50eXBlICsgIi4iICsgZmllbGQudHlwZSA6IHBhcmVudC50eXBlICsgIi4iICsgc291cmNlX29iamVjdC50eXBlICsgIi4iICsgZmllbGQudHlwZTsNCiAgICAgICAgICAgIGZpZWxkX29iamVjdC5zb2FwVHlwZSA9ICh0eXBlb2YgcGFyZW50ID09ICd1bmRlZmluZWQnKSA/IHNvdXJjZV9vYmplY3Quc29hcFR5cGUgKyAiLiIgKyBmaWVsZC5zb2FwVHlwZSA6IHBhcmVudC5zb2FwVHlwZSArICIuIiArIHNvdXJjZV9vYmplY3Quc29hcFR5cGUgKyAiLiIgKyBmaWVsZC5zb2FwVHlwZTsNCiAgICAgICAgICAgIHZhbHVlcy5wdXNoKGZpZWxkX29iamVjdCk7DQogICAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlVG8gIT0gIiIgJiYgZmllbGQucmVmZXJlbmNlVG8gIT0gbnVsbCAmJiBmaWVsZC5yZWZlcmVuY2VUbyA9PSBmaWVsZC5yZWxhdGlvbnNoaXBOYW1lKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaChmaWVsZC5yZWZlcmVuY2VUbyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCiAgICByZWZlcmVuY2VzLmVhY2goZnVuY3Rpb24ocmVmZXJlbmNlKQ0KICAgIHsNCiAgICAgICAgdmFyIHAgPSBuZXcgT2JqZWN0KCk7DQogICAgICAgIHZhciBzb3VyY2Vfb2JqZWN0ID0gc291cmNlX29iamVjdHMuZ2V0T2JqZWN0KG5hbWUpOw0KICAgICAgICBpZiAoc291cmNlX29iamVjdCAhPSBudWxsKQ0KICAgICAgICB7DQogICAgICAgICAgICBwLm5hbWUgPSAgKHR5cGVvZiBwYXJlbnQgPT0gJ3VuZGVmaW5lZCcpID8gbmFtZSA6IHBhcmVudC5uYW1lICsgIi4iICsgbmFtZTsNCiAgICAgICAgICAgIHAubGFiZWwgPSAodHlwZW9mIHBhcmVudCA9PSAndW5kZWZpbmVkJykgPyBzb3VyY2Vfb2JqZWN0LmxhYmVsIDogcGFyZW50LmxhYmVsICsgIi4iICsgc291cmNlX29iamVjdC5sYWJlbDsNCiAgICAgICAgICAgIHAudHlwZSA9ICh0eXBlb2YgcGFyZW50ID09ICd1bmRlZmluZWQnKSA/IHNvdXJjZV9vYmplY3QudHlwZSA6IHBhcmVudC50eXBlICsgIi4iICsgc291cmNlX29iamVjdC50eXBlOw0KICAgICAgICAgICAgcC5zb2FwVHlwZSA9ICh0eXBlb2YgcGFyZW50ID09ICd1bmRlZmluZWQnKSA/IHNvdXJjZV9vYmplY3Quc29hcFR5cGUgOiBwYXJlbnQuc29hcFR5cGUgKyAiLiIgKyBzb3VyY2Vfb2JqZWN0LnNvYXBUeXBlOw0KICAgICAgICAgICAgdmFyIGZpZWxkX29iamVjdHMgPSBkZXNjcmliZVNPYmplY3RzKHJlZmVyZW5jZSwgcCk7DQogICAgICAgICAgICBmaWVsZF9vYmplY3RzLmVhY2goZnVuY3Rpb24oZmllbGRfb2JqZWN0KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGZpZWxkX29iamVjdCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIHJldHVybiB2YWx1ZXM7DQp9DQoNCg0KDQoNCg0KDQoNCg0KZnVuY3Rpb24gZ2V0Q3JpdGVyaWFzKCkNCnsNCiAgICB2YXIgY3JpdGVyaWFzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoImNyaXRlcmlhIik7DQoNCiAgICBkb2pvLmxhbmcuZm9yRWFjaCgkQShlbGVtZW50cyksIGZ1bmN0aW9uKGVsZW1lbnQpDQogICAgew0KICAgICAgICB2YXIgZmllbGRzID0gRm9ybS5nZXRFbGVtZW50cyhlbGVtZW50LmlkKTsNCiAgICAgICAgdmFyIGNyaXRlcmlhID0gbmV3IEFycmF5KCk7DQogICAgICAgIGRvam8ubGFuZy5mb3JFYWNoKCRBKGZpZWxkcyksIGZ1bmN0aW9uKGZpZWxkKQ0KICAgICAgICB7DQogICAgICAgICAgICBjcml0ZXJpYVtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlOw0KICAgICAgICB9KTsNCiAgICAgICAgY3JpdGVyaWFzLnB1c2goY3JpdGVyaWEpOw0KICAgIH0pOw0KDQogICAgdmFyIG1hdGNoID0gKCQoIm1hdGNoX29yIikuY2hlY2tlZCA9PSB0cnVlKSA/ICJvciIgOiAiYW5kIjsNCiAgICB2YXIgY3JpdGVyaWFfc3RyaW5nID0gZ2V0Q3JpdGVyaWFTdHJpbmcoY3JpdGVyaWFzLCBtYXRjaCk7DQogICAgcmV0dXJuIGNyaXRlcmlhX3N0cmluZzsNCn0NCg0KZnVuY3Rpb24gZ2V0Q3JpdGVyaWFTdHJpbmcoY3JpdGVyaWFzLCBtYXRjaCkNCnsNCgl2YXIgYXJyYXkgPSBuZXcgQXJyYXkoKTsNCglhcnJheS5wdXNoKCI8Y3JpdGVyaWFzPiIpOw0KCWFycmF5LnB1c2goIjxtYXRjaD4iICsgbWF0Y2ggKyAiPC9tYXRjaD4iKTsNCglhcnJheS5wdXNoKGNyaXRlcmlhcy5tYXAoZnVuY3Rpb24oY3JpdGVyaWEpIHsNCgkJdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7DQoJCWFycmF5LnB1c2goIjxjcml0ZXJpYT4iKTsNCgkJYXJyYXkucHVzaCgiPGZpZWxkPiIgKyBjcml0ZXJpYS5maWVsZCArICI8L2ZpZWxkPiIpOw0KCQlhcnJheS5wdXNoKCI8b3BlcmFuZD4iICsgY3JpdGVyaWEub3BlcmFuZCArICI8L29wZXJhbmQ+Iik7DQoJCWFycmF5LnB1c2goIjx2YWx1ZT4iICsgY3JpdGVyaWEudmFsdWUgKyAiPC92YWx1ZT4iKTsNCgkJYXJyYXkucHVzaCgiPC9jcml0ZXJpYT4iKTsNCgkJcmV0dXJuIGFycmF5LmpvaW4oJ1xuJyk7DQoJfSkuam9pbignXG4nKSk7DQoJYXJyYXkucHVzaCgiPC9jcml0ZXJpYXM+Iik7DQoJcmV0dXJuIGFycmF5LmpvaW4oJ1xuJyk7DQp9DQoNCmlmKHR5cGVvZih3aW5kb3cuZXh0ZXJuYWwpICE9ICd1bmRlZmluZWQnKQ0Kew0KICAgIC8veWVzLCB0aGlzIGlzIGV2aWwgYnJvd3NlciBzbmlmZmluZywgYnV0IG9ubHkgSUUgaGFzIHRoaXMgYnVnDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUgPSBmdW5jdGlvbihuYW1lLCB0YWcpDQogICAgew0KICAgICAgICBpZighdGFnKQ0KICAgICAgICB7DQogICAgICAgICAgICB0YWcgPSAnKic7DQogICAgICAgIH0NCiAgICAgICAgdmFyIGVsZW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTsNCiAgICAgICAgdmFyIHJlcyA9IFtdDQogICAgICAgIGZvcih2YXIgaT0wO2k8ZWxlbXMubGVuZ3RoO2krKykNCiAgICAgICAgew0KICAgICAgICAgICAgYXR0ID0gZWxlbXNbaV0uZ2V0QXR0cmlidXRlKCduYW1lJyk7DQogICAgICAgICAgICBpZihhdHQgPT0gbmFtZSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXMucHVzaChlbGVtc1tpXSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHJlczsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGV4ZWN1dGUodHlwZSkNCnsNCiAgICBzd2l0Y2godHlwZSkNCiAgICB7DQogICAgY2FzZSAic2F2ZSI6DQogICAgICAgIHNhdmVFbWFpbEFkZHJlc3NFeHRyYWN0aW9uKCk7DQogICAgICAgIGJyZWFrOw0KICAgIGNhc2UgInNhdmVuZXciOg0KICAgICAgICBzYXZlRW1haWxBZGRyZXNzRXh0cmFjdGlvbigpOw0KICAgICAgICBicmVhazsNCiAgICBjYXNlICJjYW5jZWwiOg0KICAgICAgICBjYW5jZWxFbWFpbEFkZHJlc3NFeHRyYWN0aW9uKCk7DQogICAgICAgIGJyZWFrOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gZGlzcGxheVZpZXcoaWQpDQp7DQogICAgcGFyZW50LmxvY2F0aW9uLmhyZWYgPSAiLyIgKyBpZDsgLy8NCn0NCg0KZnVuY3Rpb24gY2FuY2VsRW1haWxBZGRyZXNzRXh0cmFjdGlvbigpDQp7DQogICAgcGFyZW50LmxvY2F0aW9uLmhyZWYgPSAieyEkUmVxdWVzdC5yZXRVUkx9IjsNCn0NCg0KZnVuY3Rpb24gc2F2ZUVtYWlsQWRkcmVzc0V4dHJhY3Rpb24oKQ0Kew0KICAgIHZhciBpZCA9ICJ7IVRSQ19BQl9fQXV0b2JhaG5FbWFpbEFkZHJlc3NFeHRyYWN0aW9uX19jLklkfSI7DQogICAgdmFyIGFkZHJlc3NfZXh0cmFjdGlvbiA9IG5ldyBzZm9yY2UuU09iamVjdCgnVFJDX0FCX19BdXRvYmFobkVtYWlsQWRkcmVzc0V4dHJhY3Rpb25fX2MnKTsNCg0KICAgIHZhciBpbnB1dF9uYW1lID0gJCgibmFtZSIpLnZhbHVlOw0KICAgIHZhciBzYXZlZF9uYW1lID0gInshVFJDX0FCX19BdXRvYmFobkVtYWlsQWRkcmVzc0V4dHJhY3Rpb25fX2MuTmFtZX0iOw0KDQogICAgaWYgKGlkICE9IHVuZGVmaW5lZCkgYWRkcmVzc19leHRyYWN0aW9uLklkID0gaWQ7DQogICAgYWRkcmVzc19leHRyYWN0aW9uLlRSQ19BQl9fTmFtZV9fYyA9ICQoIm5hbWUiKS52YWx1ZTsNCiAgICBhZGRyZXNzX2V4dHJhY3Rpb24uVFJDX0FCX19EYXRhU291cmNlX19jID0gJCgiZGF0YXNvdXJjZSIpLm9wdGlvbnNbJCgiZGF0YXNvdXJjZSIpLnNlbGVjdGVkSW5kZXhdLnZhbHVlOw0KICAgIGFkZHJlc3NfZXh0cmFjdGlvbi5UUkNfQUJfX0VtYWlsRmllbGRfX2MgPSAkKCJlbWFpbGZpZWxkIikub3B0aW9uc1skKCJlbWFpbGZpZWxkIikuc2VsZWN0ZWRJbmRleF0udmFsdWU7DQogICAgYWRkcmVzc19leHRyYWN0aW9uLlRSQ19BQl9fQ3JpdGVyaWFfX2MgPSBnZXRDcml0ZXJpYXMoKTsNCg0KICAgIHZhciBlcnJtc2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZXJyb3JEaXZfZXAiKTsNCiAgICBpZiAoZXJybXNnLmNoaWxkTm9kZXMubGVuZ3RoID09IDApDQogICAgew0KICAgICAgICBlcnJtc2cuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpKTsNCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgICAgIGVycm1zZy5jaGlsZE5vZGVzWzBdLm5vZGVWYWx1ZSA9ICIiOw0KICAgIH0NCg0KICAgIGlmIChhZGRyZXNzX2V4dHJhY3Rpb24uVFJDX0FCX19OYW1lX19jID09ICIiKQ0KICAgIHsNCiAgICAgICAgZXJybXNnLmNoaWxkTm9kZXNbMF0ubm9kZVZhbHVlID0gIpa8j8yC8JDdkuiCtYLEgq2CvoKzgqKBQiI7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgaWYgKGFkZHJlc3NfZXh0cmFjdGlvbi5UUkNfQUJfX0RhdGFTb3VyY2VfX2MgPT0gIiIpDQogICAgew0KICAgICAgICBlcnJtc2cuY2hpbGROb2Rlc1swXS5ub2RlVmFsdWUgPSAig0mDdYNXg0aDToNngvCQ3ZLogrWCxIKtgr6Cs4KigUIiOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmIChhZGRyZXNzX2V4dHJhY3Rpb24uVFJDX0FCX19FbWFpbEZpZWxkX19jID09ICIiKQ0KICAgIHsNCiAgICAgICAgZXJybXNnLmNoaWxkTm9kZXNbMF0ubm9kZVZhbHVlID0gIoOBgVuDi4NBg2iDjINYgvCQ3ZLogrWCxIKtgr6Cs4KigUIiOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgdmFyIGNhbGxiYWNrPQ0KICAgIHsgDQogICAgICAgIG9uU3VjY2VzczpmdW5jdGlvbihyZXNwb25zZSkgDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZVswXS5nZXRCb29sZWFuKCJzdWNjZXNzIikgPT0gZmFsc2UpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIGVycl90ZXh0ID0gcmVzcG9uc2VbMF0uZ2V0QXJyYXkoImVycm9ycyIpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgaWYgKCBlcnJfdGV4dC5pbmRleE9mKCJUUkNfQUJfX1VuaXF1ZU5hbWVfX2MiKSAhPSAtMSAmJiBlcnJfdGV4dC5pbmRleE9mKCJzdGF0dXNDb2RlOidEVVBMSUNBVEVfVkFMVUUnIikgIT0gLTEgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZXJybXNnLmNoaWxkTm9kZXNbMF0ubm9kZVZhbHVlID0gIoK7gsyWvI/Mgs2K+YLJk2+YXoKzguqCxIKigtyCt4FCIjsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRpc3BsYXlWaWV3KHJlc3BvbnNlWzBdLmlkKTsNCiAgICAgICAgfSwNCiAgICAgICAgb25GYWlsdXJlOmZ1bmN0aW9uKGVycm9yKQ0KICAgICAgICB7IA0KICAgICAgICAgICAgYWxlcnQoImZhaWx1cmUiICsgZXJyb3IpOw0KICAgICAgICB9IA0KICAgIH07DQogICAgdmFyIHJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwc2VydCgiSWQiLCBbYWRkcmVzc19leHRyYWN0aW9uXSwgY2FsbGJhY2spOw0KDQp9DQo=</fileContent>
    <fileName>emailaddressextraction.js</fileName>
    <name>EmailAddressExtraction_js</name>
    <supportsCaching>true</supportsCaching>
</Scontrol>
